rules:
  - id: unsafe-redirect
    patterns:
      - pattern: |
          http.Redirect($WRITER, $REQUEST, $USER_INPUT, ...)
    message: "Небезопасное перенаправление: пользовательский ввод используется в редиректе без валидации. Возможна атака 'Open Redirect'."
    languages: [go]
    severity: WARNING
    metadata:
      cwe: "CWE-601: URL Redirection to Untrusted Site"
      owasp: "A01:2021 - Broken Access Control"