rules:
  - id: deprecated-crypto-package
    patterns:
      - pattern-either:
          - pattern: |
              import "crypto/md5"
          - pattern: |
              import "crypto/sha1"
    message: "Устаревшие криптографические пакеты: избегайте MD5 и SHA1 для криптографических операций."
    languages: [go]
    severity: WARNING

  - id: insecure-random
    patterns:
      - pattern: |
          rand.Intn($N)
    pattern-not:
      - pattern: |
          rand.New(rand.NewSource($SEED)).Intn($N)
      - pattern: |
          crypto/rand.Int($READER, $N)
    message: "Небезопасный генератор случайных чисел: для криптографических операций используйте crypto/rand."
    languages: [go]
    severity: WARNING