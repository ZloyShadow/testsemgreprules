rules:
  - id: csrf-protection-missing
    patterns:
      - pattern: |
          http.HandleFunc($PATH, func(w http.ResponseWriter, r *http.Request) {
            if r.Method == "POST" {
              ...
            }
          })
    pattern-not:
      - pattern: |
          http.HandleFunc($PATH, func(w http.ResponseWriter, r *http.Request) {
            if r.Method == "POST" {
              if !isValidCSRFToken(r) {
                http.Error(w, "Invalid CSRF token", http.StatusForbidden)
                return
              }
              ...
            }
          })
    message: "CSRF защита отсутствует: для всех POST запросов требуется проверка CSRF токена."
    languages: [go]
    severity: ERROR