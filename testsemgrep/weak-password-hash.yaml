rules:
  - id: weak-password-hash
    patterns:
      - pattern-either:
          - pattern: |
              md5.Sum([]byte($PASSWORD))
          - pattern: |
              sha1.Sum([]byte($PASSWORD))
          - pattern: |
              crypto/md5.New()
          - pattern: |
              crypto/sha1.New()
    message: "Слабое хеширование паролей: используйте bcrypt, scrypt или argon2 вместо MD5/SHA1."
    languages: [go]
    severity: ERROR
    meta
      cwe: "CWE-916: Use of Password Hash With Insufficient Computational Effort"
      owasp: "A02:2021 - Cryptographic Failures"

  - id: hardcoded-credentials
    patterns:
      - pattern-either:
          - pattern: |
              const PASSWORD = "..."
          - pattern: |
              const API_KEY = "..."
          - pattern: |
              const SECRET = "..."
          - pattern: |
              const TOKEN = "..."
    message: "Жестко закодированные учетные данные: никогда не храните пароли, ключи и токены в коде."
    languages: [go]
    severity: ERROR
    meta
      cwe: "CWE-798: Use of Hard-coded Credentials"
      owasp: "A02:2021 - Cryptographic Failures"