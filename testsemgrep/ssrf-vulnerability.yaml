rules:
  - id: ssrf-vulnerability
    patterns:
      - pattern: |
          http.Get($USER_INPUT)
    pattern-not:
      - pattern: |
          if !isValidURL($USER_INPUT) {
            return fmt.Errorf("invalid URL")
          }
          http.Get($USER_INPUT)
    message: "SSRF уязвимость: пользовательский ввод используется для создания запросов без валидации. Проверяйте и санитизируйте URL."
    languages: [go]
    severity: ERROR
    meta
      cwe: "CWE-918: Server-Side Request Forgery"
      owasp: "A10:2021 - Server-Side Request Forgery"