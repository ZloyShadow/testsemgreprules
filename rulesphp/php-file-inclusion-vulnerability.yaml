rules:
  - id: php-file-inclusion-vulnerability
    patterns:
      - pattern-either:
          - pattern: |
              include($user_input);
          - pattern: |
              require($user_input);
          - pattern: |
              include_once($user_input);
          - pattern: |
              require_once($user_input);
    message: "LFI/RFI уязвимость (Local/Remote File Inclusion): пользовательский ввод используется для включения файлов. Валидируйте входные данные."
    languages: [php]
    severity: ERROR
    metadata:
      cwe: "CWE-98: Improper Control of Filename for Include/Require Statement"
      owasp: "A01:2021 - Broken Access Control"