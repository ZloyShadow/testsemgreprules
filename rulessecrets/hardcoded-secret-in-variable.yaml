  - id: hardcoded-secret-in-variable
    patterns:
      - pattern-either:
          - pattern: |
              $VAR = "$SECRET"
          - pattern: |
              $VAR := "$SECRET"
          - pattern: |
              const $VAR = "$SECRET"
          - pattern: |
              var $VAR = "$SECRET"
          - pattern: |
              let $VAR = "$SECRET"
          - pattern: |
              private static final String $VAR = "$SECRET"
          - pattern: |
              private String $VAR = "$SECRET"
          - pattern: |
              $VAR: "$SECRET"
      - pattern-regex: '(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};\':"\\\\|,.<>\\/?]{5,}'
    pattern-not:
      - pattern-regex: '(?i)test|example|sample|demo|placeholder|dummy|mock|fixture|password123|Passw0rd'
    metavariable-regex:
      metavariable: $VAR
      regex: '(?i).*(password|passwd|pwd|secret|token|api[_\\-]?key|access[_\\-]?key|private[_\\-]?key|credential|auth|certificate|cert|ssh|rsa|dsa|ecdsa|pgp|gpg|encryption|crypto|vault|wallet|wallet[_\\-]?pass|db[_\\-]?pass|database[_\\-]?pass).*'
    message: "Жестко закодированный секрет в переменной '$VAR'. Секреты должны храниться в защищенных хранилищах, а не в коде."
    languages:
      - go
      - java
      - javascript
      - python
      - ruby
      - php
      - csharp
      - kotlin
      - typescript
      - yaml
      - json
      - properties
      - env
    severity: ERROR