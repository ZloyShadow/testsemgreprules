  - id: hardcoded-secret-in-config
    patterns:
      - pattern-regex: '(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};\':"\\\\|,.<>\\/?]{5,}'
    pattern-not:
      - pattern-regex: '(?i)test|example|sample|demo|placeholder|dummy|mock|fixture|password123|Passw0rd|localhost|127\\.0\\.0\\.1'
      - pattern-regex: '\\b(sha256|sha1|md5):[a-f0-9]{32,64}\\b'
    metavariable-regex:
      metavariable: $...
      regex: '(?i).*(password|secret|token|api[_\\-]?key|access[_\\-]?key).*'
    message: "Потенциальный секрет обнаружен в конфигурационном файле. Конфигурационные файлы с секретами не должны коммититься в репозиторий."
    languages:
      - yaml
      - json
      - properties
      - ini
      - env
      - toml
    paths:
      include:
        - "*.yaml"
        - "*.yml"
        - "*.json"
        - "*.properties"
        - "*.ini"
        - "*.env"
        - "*.toml"
        - "config/*"
        - "conf/*"
        - "settings/*"
    severity: ERROR