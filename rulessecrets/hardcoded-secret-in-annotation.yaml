  - id: hardcoded-secret-in-annotation
    patterns:
      - pattern: |
          @$ANNOTATION(..., value = "$SECRET", ...)
      - pattern-regex: '(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};\':"\\\\|,.<>\\/?]{5,}'
    pattern-not:
      - pattern-regex: '(?i)test|example|sample|demo|placeholder|dummy|mock|fixture'
    metavariable-regex:
      metavariable: $ANNOTATION
      regex: '(?i).*(password|secret|credential|auth|token|key).*'
    message: "Секрет в аннотации/декораторе. Это может привести к утечке через метаданные класса."
    languages:
      - java
      - kotlin
      - python
      - csharp
    severity: WARNING