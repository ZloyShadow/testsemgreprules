rules:
  - id: potential-secret-hardcoded
    patterns:
      - pattern-regex: '(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};\':"\\\\|,.<>\\/?]{5,}'
    pattern-not:
      - pattern-regex: '(?i)test|example|sample|demo|placeholder|dummy|mock|fixture|password123|Passw0rd|Qwerty123|Abc123'
      - pattern-regex: '\\b(sha256|sha1|md5):[a-f0-9]{32,64}\\b'
      - pattern-regex: '\\b[A-F0-9]{32,64}\\b'
      - pattern-regex: '\\b[a-f0-9]{40}\\b'  # SHA1 хеши
      - pattern-regex: '\\b[A-Z0-9]{27}\\b'  # Azure Client Secret pattern (часто ложные срабатывания)
      - pattern: |
          assert $X == "..."
      - pattern: |
          assertEquals("...", $X)
      - pattern: |
          expect($X).toEqual("...")
    message: "Обнаружен потенциальный секрет/пароль в коде. Проверьте, не является ли это реальным секретом, который должен храниться в безопасном хранилище (Vault, Secrets Manager)."
    languages:
      - go
      - java
      - javascript
      - python
      - ruby
      - php
      - c
      - cpp
      - csharp
      - kotlin
      - scala
      - swift
      - typescript
      - yaml
      - json
      - properties
      - ini
      - env
      - dockerfile
      - bash
      - terraform
    severity: WARNING