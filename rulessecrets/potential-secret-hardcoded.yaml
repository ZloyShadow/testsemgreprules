rules:
  - id: potential-secret-hardcoded
    patterns:
      - pattern-regex: "(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};':\\\"\\\\|,.<>\\/?]{5,}"
    message: |
      ⚠️ Потенциальный секрет обнаружен!
      
      Эвристика: последовательность из 5+ символов с буквами в верхнем/нижнем регистре и цифрами.
      
      Рекомендации:
      1. Если это реальный секрет — удалите из кода и используйте безопасное хранилище
      2. Если это тестовые данные — добавьте комментарий // nosemgrep или измените значение
      3. Если это ложное срабатывание — добавьте исключение в правила Semgrep
    languages:
      - go
      - java
      - javascript
      - python
      - ruby
      - php
      - c
      - cpp
      - csharp
      - kotlin
      - scala
      - swift
      - typescript
      - yaml
      - json
      - dockerfile
      - bash
      - terraform
      - html
      - xml
    severity: WARNING