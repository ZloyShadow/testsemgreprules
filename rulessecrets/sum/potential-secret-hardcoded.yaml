rules:
  - id: potential-secret-hardcoded
    patterns:
      - pattern-regex: '(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};\':"\\\\|,.<>\\/?]{5,}'
    pattern-not:
      - pattern-regex: '(?i)test|example|sample|demo|placeholder|dummy|mock|fixture|password123|Passw0rd|Qwerty123|Abc123|localhost|127\\.0\\.0\\.1|0\\.0\\.0\\.0'
      - pattern-regex: '\\b(sha256|sha1|md5):[a-f0-9]{32,64}\\b'
      - pattern-regex: '\\b[A-F0-9]{32,64}\\b'
      - pattern-regex: '\\b[a-f0-9]{40,64}\\b'
      - pattern-regex: '\\b[A-Z0-9]{27}\\b'
      - pattern-regex: '\\b[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\b'  # UUID
      - pattern-regex: '\\b[A-Z]{3}[0-9]{3}\\b'  # –ö–æ–¥—ã –∞—ç—Ä–æ–ø–æ—Ä—Ç–æ–≤ –∏ —Ç.–ø.
      - pattern-regex: '\\b[A-Z][a-z]{2,10}\\d{2,4}\\b'  # –í–µ—Ä—Å–∏–∏ –ü–û: Chrome115, Firefox120
      - pattern: |
          assert $X == "..."
      - pattern: |
          assertEquals("...", $X)
      - pattern: |
          expect($X).toEqual("...")
      - pattern: |
          console.log("...")
      - pattern: |
          logger.debug("...")
      - pattern: |
          print("...")
      - pattern: |
          System.out.println("...")
    message: |
      ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω!
      
      –≠–≤—Ä–∏—Å—Ç–∏–∫–∞: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ 5+ —Å–∏–º–≤–æ–ª–æ–≤ —Å –±—É–∫–≤–∞–º–∏ –≤ –≤–µ—Ä—Ö–Ω–µ–º/–Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ –∏ —Ü–∏—Ñ—Ä–∞–º–∏.
      
      –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
      1. –ï—Å–ª–∏ —ç—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç ‚Äî —É–¥–∞–ª–∏—Ç–µ –∏–∑ –∫–æ–¥–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Vault, AWS Secrets Manager)
      2. –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π // nosemgrep –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ —è–≤–Ω–æ —Ç–µ—Å—Ç–æ–≤–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "test_password_123")
      3. –ï—Å–ª–∏ —ç—Ç–æ –ª–æ–∂–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ –ø—Ä–∞–≤–∏–ª–∞ Semgrep
      
      –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤: "MyP@ss123", "ProdEnv2024!", "Admin$Pass99"
      –ü—Ä–∏–º–µ—Ä—ã –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π: "Test123", "Version2024", "Chrome115"
    languages:
      - go
      - java
      - javascript
      - python
      - ruby
      - php
      - c
      - cpp
      - csharp
      - kotlin
      - scala
      - swift
      - typescript
      - yaml
      - json
      - properties
      - ini
      - env
      - dockerfile
      - bash
      - terraform
      - html
      - xml
    severity: WARNING
    metadata:
      category: security
      technology:
        - secrets
        - credentials
      cwe: "CWE-798: Use of Hard-coded Credentials"
      owasp: "A07:2021 - Identification and Authentication Failures"
      confidence: MEDIUM
      likelihood: HIGH
      impact: HIGH
      references:
        - https://owasp.org/www-project-top-ten/
        - https://cwe.mitre.org/data/definitions/798.html
      subcategory:
        - audit
        - secrets

  - id: hardcoded-secret-in-variable
    patterns:
      - pattern-either:
          - pattern: |
              $VAR = "$SECRET"
          - pattern: |
              $VAR := "$SECRET"
          - pattern: |
              const $VAR = "$SECRET"
          - pattern: |
              var $VAR = "$SECRET"
          - pattern: |
              let $VAR = "$SECRET"
          - pattern: |
              private static final String $VAR = "$SECRET"
          - pattern: |
              private String $VAR = "$SECRET"
          - pattern: |
              $VAR: "$SECRET"
          - pattern: |
              "$KEY": "$SECRET"
          - pattern: |
              $KEY="$SECRET"
      - pattern-regex: '(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};\':"\\\\|,.<>\\/?]{5,}'
    pattern-not:
      - pattern-regex: '(?i)test|example|sample|demo|placeholder|dummy|mock|fixture|password123|Passw0rd|Qwerty123|Abc123|localhost'
    metavariable-regex:
      metavariable: $VAR
      regex: '(?i).*(password|passwd|pwd|secret|token|api[_\\-]?key|access[_\\-]?key|private[_\\-]?key|credential|auth|certificate|cert|ssh|rsa|dsa|ecdsa|pgp|gpg|encryption|crypto|vault|wallet|db[_\\-]?pass|database[_\\-]?pass|connection[_\\-]?string).*'
    message: |
      üîí –ñ–ï–°–¢–ö–û –ó–ê–ö–û–î–ò–†–û–í–ê–ù–ù–´–ô –°–ï–ö–†–ï–¢!
      
      –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è '$VAR' —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å.
      
      –†–µ—à–µ–Ω–∏–µ:
      ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: process.env.SECRET
      ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä —Å–µ–∫—Ä–µ—Ç–æ–≤: AWS Secrets Manager, HashiCorp Vault
      ‚Ä¢ –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚Äî .env —Ñ–∞–π–ª—ã (–¥–æ–±–∞–≤—å—Ç–µ –≤ .gitignore)
    languages:
      - go
      - java
      - javascript
      - python
      - ruby
      - php
      - csharp
      - kotlin
      - typescript
      - yaml
      - json
      - properties
      - env
    severity: ERROR