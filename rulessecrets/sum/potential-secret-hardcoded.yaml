rules:
  - id: potential-secret-hardcoded
    patterns:
      - pattern-regex: "(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};':\\\"\\\\|,.<>\\/?]{5,}"
    pattern-not:
      - pattern-regex: "(?i)test|example|sample|demo|placeholder|dummy|mock|fixture|password123|Passw0rd|Qwerty123|Abc123|localhost|127\\.0\\.0\\.1|0\\.0\\.0\\.0"
      - pattern-regex: "\\b(sha256|sha1|md5):[a-f0-9]{32,64}\\b"
      - pattern-regex: "\\b[A-F0-9]{32,64}\\b"
      - pattern-regex: "\\b[a-f0-9]{40,64}\\b"
      - pattern-regex: "\\b[A-Z0-9]{27}\\b"
      - pattern-regex: "\\b[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\b"
      - pattern-regex: "\\b[A-Z]{3}[0-9]{3}\\b"
      - pattern-regex: "\\b[A-Z][a-z]{2,10}\\d{2,4}\\b"
      - pattern: |
          assert $X == "..."
      - pattern: |
          assertEquals("...", $X)
      - pattern: |
          expect($X).toEqual("...")
      - pattern: |
          console.log("...")
      - pattern: |
          logger.debug("...")
      - pattern: |
          print("...")
      - pattern: |
          System.out.println("...")
    message: |
      ⚠️ Потенциальный секрет обнаружен!
      
      Эвристика: последовательность из 5+ символов с буквами в верхнем/нижнем регистре и цифрами.
      
      Рекомендации:
      1. Если это реальный секрет — удалите из кода и используйте безопасное хранилище
      2. Если это тестовые данные — добавьте комментарий // nosemgrep или измените значение
      3. Если это ложное срабатывание — добавьте исключение в правила Semgrep
    languages:
      - go
      - java
      - javascript
      - python
      - ruby
      - php
      - c
      - cpp
      - csharp
      - kotlin
      - scala
      - swift
      - typescript
      - yaml
      - json
      - properties
      - ini
      - env
      - dockerfile
      - bash
      - terraform
      - html
      - xml
    severity: WARNING